{"version":3,"sources":["conf/search/index.js"],"names":["define","require","exports","module","$","ajax","slayer","Vue","UI","laz","component","props","items","type","Array","default","template","filter","url","search","test","userId","encodeURIComponent","sVue","el","data","keyword","input","listData","num","init","self","dropload","scrollArea","window","domDown","domClass","domRefresh","domUpdate","domLoad","loadDownFn","me","query","success","setTimeout","resetload","code","length","alertSecond","concat","lazyload","message","methods","click_input_focus","show_text_del","hide","show","find","focus","getParams","obj","location","substr","arr","split","i","l","res"],"mappings":"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","file":"../../../../conf/search/index.js","sourcesContent":["/**\n * 搜索\n * @author 黄奕海\n * @date 20170222\n * 页面引用\n *  <script src=\"__PUBLIC__/js/lithe.js\"\n data-config=\"config.js\"\n data-debug=\"true\"\n data-main=\"conf/search/index.js\">\n </script>\n */\ndefine('conf/search/index.js', function (require, exports, module) {\n    const $ = require('$'),\n        ajax = require('utils/async/ajax.js'),\n        slayer = require('mods/search/layer.js'),\n        Vue = require(\"vue\"),\n        UI = require('UI/dialog/alert.js'),\n        laz = require('utils/async/lazyload.js');\n    require('vendors/dropload.js');\n    //laz.init();\n    Vue.component(\"listmore\", {\n        props: {\n            items: {\n                type: Array,\n                default: function() {\n                    return []\n                }\n            }\n        },\n        template: \"#searchList\"\n    });\n    Vue.filter('buy',function(url){\n        var search = /\\?/.test(url);\n        if(!!userId){\n            return url + (search ? \"&\":\"?\")+\"affExtParam1=\"+userId;\n        }\n        return \"login?redirect=\"+encodeURIComponent(url)+\"&type=buy\";\n    });\n    const sVue = new Vue({\n        el:'#s_result',\n        data: {\n            keyword: keyword,\n            input: $('#s_layer_input'),\n            listData:[],\n            num :2\n        },\n        init:function(){\n            let self = this;\n            $(\"#s_result\").dropload({\n                scrollArea: window,\n                domDown: {\n                    domClass: 'dropload-down',\n                    domRefresh: '<div class=\"dropload-refresh\">↑Pull-up loading</div>',\n                    domUpdate: '<div class=\"dropload-update\">↓Release loading</div>',\n                    domLoad: '<div class=\"dropload-load\"><span class=\"loading\"></span>In loading...</div>'\n                },\n                loadDownFn: function(me) {\n                    ajax.query({\n                        url: \"/api/ext/item/searchItems?keyword=\"+keyword+\"&pageNum=\"+ (self.num++),\n                        success: function(data) {\n                            setTimeout(function() {\n                                me.resetload();\n                            }, 300);\n                            if (data.code === 200) {\n                                if (!data.data.items.length) {\n                                    UI.alertSecond(\"Data is loaded\");\n                                    return;\n                                }\n                                self.listData = self.listData.concat(data.data.items);\n                                laz.lazyload();\n                            } else {\n                                UI.alertSecond(data.message);\n                            }\n                        }\n                    });\n                }\n            });\n        },\n        methods:{\n            click_input_focus:function(){\n                slayer.keyword = this.keyword;\n                slayer.show_text_del = 1;\n                $(\"#s_result\").hide();\n                $('#s_layer').show().find(\"input\").focus();\n            }\n        }\n    })\n    function getParams(url) { //获取url传递的参数*/\n        var obj = {};\n        url = url || location.search;\n        url = /^\\?.*/i.test(url) ? url.substr(1) : url;\n        var arr = url.split(\"&\");\n        for (var i = 0, l = arr.length; i < l; i++) {\n            var res = arr[i].split(\"=\");\n            obj[res[0]] = res[1]\n        }\n        return obj;\n    }\n});\n"]}