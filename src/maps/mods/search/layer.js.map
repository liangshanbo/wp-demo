{"version":3,"sources":["mods/search/layer.js"],"names":["define","require","exports","module","$","ajax","shistory","UI","Vue","dom","input","layer","result","keyword","setH","searchVue","el","data","isShow","getH","length","his_data","tab","sortCriteria","sort","pageNum","scTop","computed","searchList","methods","go_search","val","str","objToString","layer_hide","location","assign","alertSecond","input_input","setTimeout","layer_show","scrollTop","hide","show","find","focus","click_text_null","click_del_his","rmH","obj","i","substr"],"mappings":"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","file":"../../../js_es6/mods/search/layer.js","sourcesContent":["/**\n * 搜索弹层\n * @author 黄奕海\n * @date 20170222\n *\n */\ndefine('mods/search/layer.js', function (require, exports, module) {\n    const $ = require('$'),\n        ajax = require('utils/async/ajax.js'),\n        shistory = require('mods/search/history.js'),\n        UI = require('UI/dialog/alert.js'),\n        Vue = require(\"vue\");\n    const dom = {\n        input:$('#s_layer_input'),\n        layer:$('#s_layer'),\n        result:$('#s_result')\n    };\n    if(keyword !== \"\"){\n        shistory.setH(keyword);\n    }\n    const searchVue = new Vue({\n        el:\"#s_layer\",\n        data:{\n            isShow: shistory.getH()?shistory.getH().length:0,\n            his_data: shistory.getH(),\n            keyword:keyword,\n            tab:{\n                sortCriteria:0,\n                sort:0,\n                pageNum:1\n            },\n            scTop:0\n        },\n        computed:{\n            searchList:function(){\n                return {\n                    sortCriteria:this.tab['sortCriteria'],\n                    sort:this.tab['sort'],\n                    pageNum:this.tab['pageNum'],\n                    keyword:this.keyword\n                }\n            }\n        },\n        methods:{\n            go_search:function(){\n                let val = dom.input.val(),\n                    str = this.objToString(this.searchList);\n                if(val!==\"\"){\n                    this.layer_hide();\n                    location.assign('/search'+str);\n                }else{\n                    UI.alertSecond(\"Enter search keywords\")\n                }\n            },\n            input_input:function(){\n                if(dom.input.val() === \"\"){//苹果手机删除问题\n                    setTimeout(function(){\n                        dom.input.val(\"\")\n                    },50)\n                }\n            },\n            layer_show:function(){\n                this.scTop = $('body').scrollTop();\n                dom.result.hide();\n                dom.layer.show().find(\"input\").focus();\n            },\n            layer_hide:function(){\n                dom.layer.hide();\n                dom.result.show();\n                setTimeout(()=> {\n                    $('body').scrollTop(this.scTop);\n                },50)\n            },\n            click_text_null:function(){\n                this.keyword = \"\";\n                dom.input.focus();\n            },\n            click_del_his: function(){\n                this.isShow = 0;\n                shistory.rmH();\n            },\n            objToString:function(obj){\n                let str = \"\";\n                for(let i in obj){\n                    str += '&'+i+'='+obj[i];\n                }\n                return '?'+str.substr(1);\n            }\n        }\n    });\n    module.exports = searchVue;\n});\n"]}