{"version":3,"sources":["conf/mall/hot.js"],"names":["define","require","exports","module","Ajax","Vue","UI","laz","BP","dropload","component","props","items","type","Array","default","template","sVue","el","data","moreData","num","noMore","pType","pdPos","dom","created","self","init","$","scrollArea","window","domDown","domClass","domRefresh","wapcsspath","domUpdate","domLoad","domUp","loadUpFn","me","setTimeout","resetload","location","reload","loadDownFn","str","query","url","success","code","length","alertSecond","lock","concat","lazyload","message","buy","search","test","userId","encodeURIComponent"],"mappings":"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","file":"../../../js_es6/conf/mall/hot.js","sourcesContent":["/**\n * mall列表 热销\n * @author huangyihai\n * @date 20170216\n * 页面引用 入口在首页\n *  <script src=\"__PUBLIC__/js/lithe.js\"\n data-config=\"config.js\"\n data-debug=\"true\"\n data-main=\"conf/mall/hot.js\">\n </script>\n */\ndefine('conf/mall/hot.js', function (require, exports, module) {\n    require(\"$\");\n    let Ajax = require(\"utils/async/ajax\"),\n        Vue = require(\"vue\"),\n        UI = require('UI/dialog/alert.js'),\n        laz = require('utils/async/lazyload.js'),\n        BP =  require('mods/buried_point.js'),\n        dropload;\n    require('mods/filters/com');\n    require('vendors/dropload.js');\n    Vue.component(\"listmore\", {\n        props: {\n            items: {\n                type: Array,\n                default: function() {\n                    return []\n                }\n            }\n        },\n        template: \"#template\"\n    });\n    let sVue = new Vue({\n        el: \"body\",\n        data: {\n            moreData: [],\n            type:0, //0热销 1白菜价\n            num:2,\n            noMore:0, //1没有更多了\n            pType:\"5\",\n            pdPos:\"\",\n            dom:\"#good-list\"\n        },\n        created:function(){\n            let self = this;\n            BP.init({\n                dom:self.dom,\n                pdPos:self.pdPos,\n                pType:self.pType\n            });//商品list曝光\n        },\n        init: function() {\n            let self = this;\n            dropload = $(\"#good-list\").dropload({\n                scrollArea: window,\n                domDown: {\n                    domClass: 'dropload-down',\n                    domRefresh: '<div class=\"dropload-refresh\"><img src=\"' + wapcsspath + '/images/common/loading.png\" alt=\"\"/></div>',\n                    domUpdate: '<div class=\"dropload-update\"><img src=\"' + wapcsspath + '/images/common/loading.png\" alt=\"\"/></div>',\n                    domLoad: '<div class=\"dropload-load\"><img src=\"' + wapcsspath + '/images/common/loading.gif\" alt=\"\"/></div>'\n                },\n                domUp: {\n                    domClass: 'dropload-up',\n                    domRefresh: '<div class=\"dropload-refresh\"><img src=\"'+wapcsspath+'/images/common/loading.png\" alt=\"\"/></div>',\n                    domUpdate: '<div class=\"dropload-update\"><img src=\"'+wapcsspath+'/images/common/loading.png\" alt=\"\"/></div>',\n                    domLoad: '<div class=\"dropload-load\"><img src=\"'+wapcsspath+'/images/common/loading.gif\" alt=\"\"/></div>'\n                },\n                loadUpFn: function (me) {\n                    setTimeout(function () {\n                        me.resetload();\n                        location.reload(true);\n                    }, 500);\n                },\n                loadDownFn: function(me) {\n                    let str = self.type === 0 ? 'hotSalesItems':'bargainItems';\n                    Ajax.query({\n                        url: `/api/ext/item/${str}?pageNum=${self.num++}&pageSize=10`,\n                        success: function(data) {\n                            setTimeout(function() {\n                                me.resetload();\n                            }, 300);\n                            if (data.code === 200) {\n                                if (!data.data.items.length) {\n                                    UI.alertSecond(\"Data is loaded\");\n                                    return;\n                                }\n                                if(data.data.items.length<10){\n                                    self.noMore = 1;\n                                    dropload.lock();\n                                }\n                                self.moreData = self.moreData.concat(data.data.items);\n                                laz.lazyload();\n                            } else {\n                                UI.alertSecond(data.message);\n\n                            }\n                        }\n                    });\n                }\n            });\n        }\n    });\n    function buy(url) {\n        let search = /\\?/.test(url);\n        if (userId !== \"0\") {\n            return url + (search ? \"&\" : \"?\") + \"affExtParam1=\" + userId;\n        }\n        return \"login?redirect=\" + encodeURIComponent(url) + \"&type=buy\";\n    }\n    module.exports = sVue;\n});\n\n"]}