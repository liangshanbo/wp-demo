{"version":3,"sources":["conf/mine/collection.js"],"names":["define","require","exports","module","$","ajax","Vue","UI","laz","drods","component","props","items","type","Array","default","template","filter","url","search","test","userId","encodeURIComponent","el","data","listData","num","init","self","dropload","scrollArea","window","domDown","domClass","domRefresh","wapcsspath","domUpdate","domLoad","domUp","loadUpFn","me","setTimeout","resetload","location","reload","children","length","loadDownFn","query","success","code","alertSecond","concat","lazyload","message"],"mappings":";;AAAA;;;;;;;;;;;AAWAA,OAAO,yBAAP,EAAkC,UAAUC,OAAV,EAAmBC,OAAnB,EAA4BC,MAA5B,EAAoC;AAClE,QAAMC,IAAIH,QAAQ,GAAR,CAAV;AAAA,QACII,OAAOJ,QAAQ,qBAAR,CADX;AAAA,QAEIK,MAAML,QAAQ,KAAR,CAFV;AAAA,QAGIM,KAAKN,QAAQ,oBAAR,CAHT;AAAA,QAIIO,MAAMP,QAAQ,yBAAR,CAJV;AAKAA,YAAQ,qBAAR;AACA;AACA,QAAIQ,cAAJ;AACAH,QAAII,SAAJ,CAAc,UAAd,EAA0B;AACtBC,eAAO;AACHC,mBAAO;AACHC,sBAAMC,KADH;AAEHC,yBAAS,oBAAW;AAChB,2BAAO,EAAP;AACH;AAJE;AADJ,SADe;AAStBC,kBAAU;AATY,KAA1B;AAWAV,QAAIW,MAAJ,CAAW,KAAX,EAAiB,UAASC,GAAT,EAAa;AAC1B,YAAIC,SAAS,KAAKC,IAAL,CAAUF,GAAV,CAAb;AACA,YAAGG,WAAS,GAAZ,EAAgB;AACZ,mBAAOH,OAAOC,SAAS,GAAT,GAAa,GAApB,IAAyB,eAAzB,GAAyCE,MAAhD;AACH;AACD,eAAO,oBAAkBC,mBAAmBJ,GAAnB,CAAlB,GAA0C,WAAjD;AACH,KAND;AAOA,QAAIZ,GAAJ,CAAQ;AACJiB,YAAG,MADC;AAEJC,cAAM;AACFC,sBAAS,EADP;AAEFC,iBAAK;AAFH,SAFF;;AAOJC,cAAK,gBAAU;AACX,gBAAIC,OAAO,IAAX;AACAnB,oBAAQL,EAAE,MAAF,EAAUyB,QAAV,CAAmB;AACvBC,4BAAYC,MADW;AAEvBC,yBAAS;AACLC,8BAAU,eADL;AAELC,gCAAY,6CAA2CC,UAA3C,GAAsD,4CAF7D;AAGLC,+BAAW,4CAA0CD,UAA1C,GAAqD,4CAH3D;AAILE,6BAAS,0CAAwCF,UAAxC,GAAmD;AAJvD,iBAFc;AAQvBG,uBAAO;AACHL,8BAAU,aADP;AAEHC,gCAAY,6CAA2CC,UAA3C,GAAsD,4CAF/D;AAGHC,+BAAW,4CAA0CD,UAA1C,GAAqD,4CAH7D;AAIHE,6BAAS,0CAAwCF,UAAxC,GAAmD;AAJzD,iBARgB;AAcvBI,0BAAU,kBAAUC,EAAV,EAAc;AACpBC,+BAAW,YAAY;AACnBD,2BAAGE,SAAH;AACAC,iCAASC,MAAT,CAAgB,IAAhB;AACH,qBAHD,EAGG,GAHH;AAIH;AAnBsB,aAAnB,CAAR;AAqBA,gBAAGxC,EAAE,aAAF,EAAiByC,QAAjB,CAA0B,IAA1B,EAAgCC,MAAhC,IAAwC,EAA3C,EAA8C;AAC1CrC,sBAAMsC,UAAN,GAAmB,UAASP,EAAT,EAAa;AAC5BnC,yBAAK2C,KAAL,CAAW;AACP9B,6BAAK,6BAA6BU,KAAKF,GAAL,EAA7B,GAAyC,cADvC;AAEPuB,iCAAS,iBAASzB,IAAT,EAAe;AACpBiB,uCAAW,YAAW;AAClBD,mCAAGE,SAAH;AACH,6BAFD,EAEG,GAFH;AAGA,gCAAIlB,KAAK0B,IAAL,KAAc,GAAlB,EAAuB;AACnB,oCAAI,CAAC1B,KAAKA,IAAL,CAAUZ,KAAV,CAAgBkC,MAArB,EAA6B;AACzBvC,uCAAG4C,WAAH,CAAe,gBAAf;AACA;AACH;AACDvB,qCAAKH,QAAL,GAAgBG,KAAKH,QAAL,CAAc2B,MAAd,CAAqB5B,KAAKA,IAAL,CAAUZ,KAA/B,CAAhB;AACAJ,oCAAI6C,QAAJ;AACH,6BAPD,MAOO;AACH9C,mCAAG4C,WAAH,CAAe3B,KAAK8B,OAApB;AACH;AACJ;AAhBM,qBAAX;AAkBH,iBAnBD;AAoBH;AACJ;AApDG,KAAR;AAsDH,CAjFD","file":"../../../js_es6/conf/mine/collection.js","sourcesContent":["/**\n * 收藏列表\n * @author 黄奕海\n * @date 20170308\n * 页面引用\n *  <script src=\"__PUBLIC__/js/lithe.js\"\n data-config=\"config.js\"\n data-debug=\"true\"\n data-main=\"conf/mine/collection.js\">\n </script>\n */\ndefine('conf/mine/collection.js', function (require, exports, module) {\n    const $ = require('$'),\n        ajax = require('utils/async/ajax.js'),\n        Vue = require(\"vue\"),\n        UI = require('UI/dialog/alert.js'),\n        laz = require('utils/async/lazyload.js');\n    require('vendors/dropload.js');\n    //laz.init();\n    let drods;\n    Vue.component(\"listmore\", {\n        props: {\n            items: {\n                type: Array,\n                default: function() {\n                    return []\n                }\n            }\n        },\n        template: \"#collectionList\"\n    });\n    Vue.filter('buy',function(url){\n        var search = /\\?/.test(url);\n        if(userId!==\"0\"){\n            return url + (search ? \"&\":\"?\")+\"affExtParam1=\"+userId;\n        }\n        return \"login?redirect=\"+encodeURIComponent(url)+\"&type=buy\";\n    });\n    new Vue({\n        el:'body',\n        data: {\n            listData:[],\n            num :2\n        },\n\n        init:function(){\n            let self = this;\n            drods = $(\"body\").dropload({\n                scrollArea: window,\n                domDown: {\n                    domClass: 'dropload-down',\n                    domRefresh: '<div class=\"dropload-refresh\"><img src=\"'+wapcsspath+'/images/common/loading.png\" alt=\"\"/></div>',\n                    domUpdate: '<div class=\"dropload-update\"><img src=\"'+wapcsspath+'/images/common/loading.png\" alt=\"\"/></div>',\n                    domLoad: '<div class=\"dropload-load\"><img src=\"'+wapcsspath+'/images/common/loading.gif\" alt=\"\"/></div>'\n                },\n                domUp: {\n                    domClass: 'dropload-up',\n                    domRefresh: '<div class=\"dropload-refresh\"><img src=\"'+wapcsspath+'/images/common/loading.png\" alt=\"\"/></div>',\n                    domUpdate: '<div class=\"dropload-update\"><img src=\"'+wapcsspath+'/images/common/loading.png\" alt=\"\"/></div>',\n                    domLoad: '<div class=\"dropload-load\"><img src=\"'+wapcsspath+'/images/common/loading.gif\" alt=\"\"/></div>'\n                },\n                loadUpFn: function (me) {\n                    setTimeout(function () {\n                        me.resetload();\n                        location.reload(true);\n                    }, 500);\n                }\n            });\n            if($('.goods-list').children('li').length>=10){\n                drods.loadDownFn = function(me) {\n                    ajax.query({\n                        url: \"/api/user/items?pageNum=\"+ (self.num++)+\"&pageSize=10\",\n                        success: function(data) {\n                            setTimeout(function() {\n                                me.resetload();\n                            }, 300);\n                            if (data.code === 200) {\n                                if (!data.data.items.length) {\n                                    UI.alertSecond(\"Data is loaded\");\n                                    return;\n                                }\n                                self.listData = self.listData.concat(data.data.items);\n                                laz.lazyload();\n                            } else {\n                                UI.alertSecond(data.message);\n                            }\n                        }\n                    });\n                }\n            }\n        }\n    })\n});\n"]}