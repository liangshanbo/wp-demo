{"version":3,"sources":["conf/account/index.js"],"names":["define","require","exports","module","$","ajax","UI","Vue","laz","pageSize","$accountList","init","bindEvents","component","props","details","type","Array","template","vm","el","data","currentPageNum","accountDetailsData","reqDisabled","dropload","scrollArea","window","domDown","domClass","domRefresh","wapcsspath","domUpdate","domLoad","loadDownFn","me","alertSecond","resetload","query","url","success","res","code","length","concat","lazyload","message"],"mappings":";;AAAA;;;;;;;;;;;AAWAA,OAAO,uBAAP,EAAgC,UAASC,OAAT,EAAkBC,OAAlB,EAA2BC,MAA3B,EAAmC;AAC/D,QAAMC,IAAIH,QAAQ,GAAR,CAAV;AACA,QAAMI,OAAOJ,QAAQ,qBAAR,CAAb;AACA,QAAMK,KAAKL,QAAQ,iBAAR,CAAX;AACAA,YAAQ,kBAAR;AACA,QAAMM,MAAMN,QAAQ,KAAR,CAAZ;AACA;AACAA,YAAQ,qBAAR;AACA,QAAMO,MAAMP,QAAQ,yBAAR,CAAZ;;AAEA,QAAIQ,WAAW,EAAf;AACA,QAAIC,eAAeN,EAAE,cAAF,CAAnB;;AAEAO;;AAEA,aAASA,IAAT,GAAgB;AACZC;AACA;AACAL,YAAIM,SAAJ,CAAc,mBAAd,EAAmC;AAC/BC,mBAAO;AACHC,yBAAS;AACLC,0BAAMC;AADD;AADN,aADwB;AAM/BC,sBAAU;AANqB,SAAnC;AAQA,YAAIC,KAAK,IAAIZ,GAAJ,CAAQ;AACba,gBAAI,MADS;AAEbC,kBAAM;AACFC,gCAAgB,CADd;AAEFC,oCAAoB,EAFlB;AAGFd,kCAHE;AAIFe,6BAAa;AAJX,aAFO;AAQbb,gBARa,kBAQN;AACHD,6BAAae,QAAb,CAAsB;AAClBC,gCAAYC,MADM;AAElBC,6BAAS;AACLC,kCAAU,eADL;AAELC,oCAAY,6CAA2CC,UAA3C,GAAsD,4CAF7D;AAGLC,mCAAW,4CAA0CD,UAA1C,GAAqD,4CAH3D;AAILE,iCAAS,0CAAwCF,UAAxC,GAAmD;AAJvD,qBAFS;AAQlBG,8BARkB,sBAQPC,EARO,EAQH;AACX,4BAAIhB,GAAGK,WAAP,EAAoB;AAChBlB,+BAAG8B,WAAH,CAAe,uBAAf;AACAD,+BAAGE,SAAH;AACH,yBAHD,MAGO;AACHhC,iCAAKiC,KAAL,CAAW;AACPC,wEAAsC,EAAEpB,GAAGG,cAA3C,kBAAsEH,GAAGV,QADlE;AAEP+B,uCAFO,mBAECC,GAFD,EAEM;AACT,wCAAIA,IAAIC,IAAJ,KAAa,GAAjB,EAAsB;AAClB,4CAAID,IAAIpB,IAAJ,CAASN,OAAT,CAAiB4B,MAAjB,GAA0B,CAA9B,EAAiC;AAC7BxB,+CAAGI,kBAAH,GAAwBJ,GAAGI,kBAAH,CAAsBqB,MAAtB,CAA6BH,IAAIpB,IAAJ,CAASN,OAAtC,CAAxB;AACAP,gDAAIqC,QAAJ;AACH,yCAHD,MAGO;AACHvC,+CAAG8B,WAAH,CAAe,uBAAf;AACAjB,+CAAGK,WAAH,GAAiB,IAAjB;AACH;AACJ,qCARD,MAQO;AACHlB,2CAAG8B,WAAH,CAAeK,IAAIK,OAAnB;AACH;AACDX,uCAAGE,SAAH;AACH;AAfM,6BAAX;AAiBH;AACJ;AA/BiB,iBAAtB;AAiCH;AA1CY,SAAR,CAAT;AA4CH;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,aAASzB,UAAT,GAAsB;AAClB;AACA;AACA;AACA;AACA;AACH;AAEJ,CAvGD","file":"../../../../conf/account/index.js","sourcesContent":["/**\r\n * 账户余额明细\r\n * @author 张恩铭\r\n * @date 20170323\r\n * 页面引用\r\n *  <script src=\"__PUBLIC__/js/lithe.js\"\r\n data-config=\"config.js\"\r\n data-debug=\"true\"\r\n data-main=\"conf/account/index.js\">\r\n </script>\r\n */\r\ndefine('conf/account/index.js', function(require, exports, module) {\r\n    const $ = require('$');\r\n    const ajax = require('utils/async/ajax.js');\r\n    const UI = require('UI/dialog/alert');\r\n    require('mods/filters/com');\r\n    const Vue = require('vue');\r\n    // 这个插件的文档 https://github.com/ximan/dropload\r\n    require('vendors/dropload.js');\r\n    const laz = require('utils/async/lazyload.js');\r\n\r\n    let pageSize = 10;\r\n    let $accountList = $('.accountlist');\r\n\r\n    init();\r\n\r\n    function init() {\r\n        bindEvents();\r\n        // setFilters();\r\n        Vue.component('account-list-more', {\r\n            props: {\r\n                details: {\r\n                    type: Array,\r\n                },\r\n            },\r\n            template: '#account-list-more-template',\r\n        });\r\n        let vm = new Vue({\r\n            el: 'body',\r\n            data: {\r\n                currentPageNum: 1,\r\n                accountDetailsData: [],\r\n                pageSize,\r\n                reqDisabled: false,\r\n            },\r\n            init() {\r\n                $accountList.dropload({\r\n                    scrollArea: window,\r\n                    domDown: {\r\n                        domClass: 'dropload-down',\r\n                        domRefresh: '<div class=\"dropload-refresh\"><img src=\"'+wapcsspath+'/images/common/loading.png\" alt=\"\"/></div>',\r\n                        domUpdate: '<div class=\"dropload-update\"><img src=\"'+wapcsspath+'/images/common/loading.png\" alt=\"\"/></div>',\r\n                        domLoad: '<div class=\"dropload-load\"><img src=\"'+wapcsspath+'/images/common/loading.gif\" alt=\"\"/></div>'\r\n                    },\r\n                    loadDownFn(me) {\r\n                        if (vm.reqDisabled) {\r\n                            UI.alertSecond('No More Transactions.');\r\n                            me.resetload();\r\n                        } else {\r\n                            ajax.query({\r\n                                url: `/api/account/balance?&pageNum=${++vm.currentPageNum}&pageSize=${vm.pageSize}`,\r\n                                success(res) {\r\n                                    if (res.code === 200) {\r\n                                        if (res.data.details.length > 0) {\r\n                                            vm.accountDetailsData = vm.accountDetailsData.concat(res.data.details);\r\n                                            laz.lazyload();\r\n                                        } else {\r\n                                            UI.alertSecond('No More Transactions.');\r\n                                            vm.reqDisabled = true;\r\n                                        }\r\n                                    } else {\r\n                                        UI.alertSecond(res.message);\r\n                                    }\r\n                                    me.resetload();\r\n                                },\r\n                            });\r\n                        }\r\n                    },\r\n                });\r\n            },\r\n        });\r\n    }\r\n\r\n    // function setFilters() {\r\n    //     Vue.filter('time', function(time, separator) {\r\n    //         var date = new Date(time);\r\n    //         var year = date.getFullYear();\r\n    //         var month = (date.getMonth() + 1) > 9 ? (date.getMonth() + 1) : '0' + (date.getMonth() + 1);\r\n    //         var day = date.getDate() > 9 ? date.getDate() : '0' + date.getDate();\r\n    //         var dateStr = '';\r\n    //         if (separator) {\r\n    //            dateStr += day + separator + month + separator + year;\r\n    //         } else {\r\n    //            dateStr += day + '/' + month + '/' + year;\r\n    //         }\r\n    //         return dateStr;\r\n    //     });\r\n    //     Vue.filter('toInt', function(string){\r\n    //         return Math.round(num / 100);\r\n    //     });\r\n    //     Vue.filter('to2digitFloat', function(money){\r\n    //         return (num / 100).toFixed(2);\r\n    //     });\r\n    // }\r\n\r\n\r\n    function bindEvents() {\r\n        // let threshold = $('.hmoney').height();\r\n        // $(window).on('scroll', function() {\r\n        //     let sc = document.body.scrollTop;\r\n        //     $('.header-title').text(sc > threshold ? 'Transactions' : 'My Balance');\r\n        // });\r\n    }\r\n\r\n});\r\n"]}