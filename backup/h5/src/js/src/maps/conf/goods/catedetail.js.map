{"version":3,"sources":["conf/goods/catedetail.js"],"names":["define","require","exports","module","Ajax","Vue","UI","laz","component","props","items","type","Array","default","template","filter","url","search","test","userId","encodeURIComponent","el","data","moreData","num","init","self","$","dropload","scrollArea","window","domDown","domClass","domRefresh","domUpdate","domLoad","loadDownFn","me","query","cateId","success","setTimeout","resetload","code","length","alertSecond","concat","lazyload","message"],"mappings":";;AAAA;;;;;;;;;;;;AAYAA,OAAO,0BAAP,EAAmC,UAAUC,OAAV,EAAmBC,OAAnB,EAA4BC,MAA5B,EAAoC;AACnEF,YAAQ,GAAR;AACA,QAAIG,OAAOH,QAAQ,kBAAR,CAAX;AAAA,QACII,MAAMJ,QAAQ,KAAR,CADV;AAAA,QAEIK,KAAKL,QAAQ,oBAAR,CAFT;AAAA,QAGIM,MAAMN,QAAQ,yBAAR,CAHV;AAIAA,YAAQ,qBAAR;AACAI,QAAIG,SAAJ,CAAc,UAAd,EAA0B;AACtBC,eAAO;AACHC,mBAAO;AACHC,sBAAMC,KADH;AAEHC,yBAAS,oBAAW;AAChB,2BAAO,EAAP;AACH;AAJE;AADJ,SADe;AAStBC,kBAAU;AATY,KAA1B;AAWAT,QAAIU,MAAJ,CAAW,KAAX,EAAiB,UAASC,GAAT,EAAa;AAC1B,YAAIC,SAAS,KAAKC,IAAL,CAAUF,GAAV,CAAb;AACA,YAAG,CAAC,CAACG,MAAL,EAAY;AACR,mBAAOH,OAAOC,SAAS,GAAT,GAAa,GAApB,IAAyB,eAAzB,GAAyCE,MAAhD;AACH;AACD,eAAO,oBAAkBC,mBAAmBJ,GAAnB,CAAlB,GAA0C,WAAjD;AACH,KAND;AAOA,QAAIX,GAAJ,CAAQ;AACJgB,YAAI,MADA;AAEJC,cAAM;AACFC,sBAAU,EADR;AAEFC,iBAAI;AAFF,SAFF;AAMJC,cAAM,gBAAW;AACb,gBAAIC,OAAO,IAAX;AACAC,cAAE,MAAF,EAAUC,QAAV,CAAmB;AACfC,4BAAYC,MADG;AAEfC,yBAAS;AACLC,8BAAU,eADL;AAELC,gCAAY,sDAFP;AAGLC,+BAAW,qDAHN;AAILC,6BAAS;AAJJ,iBAFM;AAQfC,4BAAY,oBAASC,EAAT,EAAa;AACrBjC,yBAAKkC,KAAL,CAAW;AACPtB,6BAAK,0CAAwCuB,MAAxC,GAA+C,WAA/C,GAA4Db,KAAKF,GAAL,EAD1D;AAEPgB,iCAAS,iBAASlB,IAAT,EAAe;AACpBmB,uCAAW,YAAW;AAClBJ,mCAAGK,SAAH;AACH,6BAFD,EAEG,GAFH;AAGA,gCAAIpB,KAAKqB,IAAL,KAAc,GAAlB,EAAuB;AACnB,oCAAI,CAACrB,KAAKA,IAAL,CAAUZ,KAAV,CAAgBkC,MAArB,EAA6B;AACzBtC,uCAAGuC,WAAH,CAAe,gBAAf;AACA;AACH;AACDnB,qCAAKH,QAAL,GAAgBG,KAAKH,QAAL,CAAcuB,MAAd,CAAqBxB,KAAKA,IAAL,CAAUZ,KAA/B,CAAhB;AACAH,oCAAIwC,QAAJ;AACH,6BAPD,MAOO;AACHzC,mCAAGuC,WAAH,CAAevB,KAAK0B,OAApB;AACH;AACJ;AAhBM,qBAAX;AAkBH;AA3Bc,aAAnB;AA8BH;AAtCG,KAAR;AAwCH,CAjED","file":"../../../../conf/goods/catedetail.js","sourcesContent":["/**\n * 商品分类\n * @author huangyihai\n * @date 20170227\n * 页面引用\n *  <script src=\"__PUBLIC__/js/lithe.js\"\n data-config=\"config.js\"\n data-debug=\"true\"\n data-main=\"conf/goods/catedetail.js\">\n </script>\n */\n\ndefine('conf/goods/catedetail.js', function (require, exports, module) {\n    require(\"$\");\n    let Ajax = require(\"utils/async/ajax\"),\n        Vue = require(\"vue\"),\n        UI = require('UI/dialog/alert.js'),\n        laz = require('utils/async/lazyload.js');\n    require('vendors/dropload.js');\n    Vue.component(\"listmore\", {\n        props: {\n            items: {\n                type: Array,\n                default: function() {\n                    return []\n                }\n            }\n        },\n        template: \"#details\"\n    });\n    Vue.filter('buy',function(url){\n        var search = /\\?/.test(url);\n        if(!!userId){\n            return url + (search ? \"&\":\"?\")+\"affExtParam1=\"+userId;\n        }\n        return \"login?redirect=\"+encodeURIComponent(url)+\"&type=buy\";\n    });\n    new Vue({\n        el: \"body\",\n        data: {\n            moreData: [],\n            num:2\n        },\n        init: function() {\n            let self = this;\n            $(\"body\").dropload({\n                scrollArea: window,\n                domDown: {\n                    domClass: 'dropload-down',\n                    domRefresh: '<div class=\"dropload-refresh\">↑Pull-up loading</div>',\n                    domUpdate: '<div class=\"dropload-update\">↓Release loading</div>',\n                    domLoad: '<div class=\"dropload-load\"><span class=\"loading\"></span>In loading...</div>'\n                },\n                loadDownFn: function(me) {\n                    Ajax.query({\n                        url: \"/api/ext/item/searchItems?categoryId=\"+cateId+\"&pageNum=\"+(self.num++),\n                        success: function(data) {\n                            setTimeout(function() {\n                                me.resetload();\n                            }, 300);\n                            if (data.code === 200) {\n                                if (!data.data.items.length) {\n                                    UI.alertSecond(\"Data is loaded\");\n                                    return;\n                                }\n                                self.moreData = self.moreData.concat(data.data.items);\n                                laz.lazyload();\n                            } else {\n                                UI.alertSecond(data.message);\n                            }\n                        }\n                    });\n                }\n            });\n\n        }\n    });\n});"]}