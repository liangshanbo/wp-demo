{"version":3,"sources":["conf/index/index.js"],"names":["define","require","exports","module","Ajax","Vue","UI","searchLayer","laz","Swiper","dlApp","appCall","getParams","BP","params","mine","$","login","navH","parseFloat","height","headerCate","downLoadH","on","ga","callApp","url","component","props","items","type","Array","default","template","pageNum","el","data","moreData","init","pagination","paginationClickable","slidesPerView","children","length","loop","lazyLoading","scrollTop","show","hide","dom","pdPos","pType","self","dropload","scrollArea","window","domDown","domClass","domRefresh","wapcsspath","domUpdate","domLoad","loadDownFn","me","query","success","setTimeout","resetload","code","alertSecond","concat","lazyload","message","methods","click_show_slayer","layer_show","click_close_down","click_down","e","target","srcElement","$target","hasClass","dl","scTop"],"mappings":"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","file":"../../../js_es6/conf/index/index.js","sourcesContent":["/**\n * title: 商品列表页\n * author: wangchunpeng\n * time: 2017-02-20\n */\ndefine('conf/index/index.js', function(require, exports, module) {\n    require(\"$\");\n    let Ajax = require(\"utils/async/ajax\"),\n        Vue = require(\"vue\"),\n        UI = require('UI/dialog/alert.js'),\n        searchLayer = require('mods/search/layer'),\n        laz = require('utils/async/lazyload.js'),\n        Swiper = require('mods/swiper'),\n        dlApp = require(\"utils/dlApp\"),\n        appCall = require(\"utils/appCall\"),\n        getParams = require(\"mods/getParams\"),\n        BP =  require('mods/buried_point.js');\n    // touchSlide = require('vendors/TouchSlide');\n    require('mods/filters/com');\n    require('vendors/dropload.js');\n    //Vue.config.debug=true;\n    /**\n     * title: 判断是否需要打开app\n     * desc: 短信分享的链接需要直接打开app（2017.04.24 wangchunpeng）\n     */\n    let params = getParams();\n    let mine=$(\".search-mine\");\n    let login=$(\".search-login\"),\n        navH = parseFloat($('.nav').height()),\n        headerCate = $('#headerCate'),\n        downLoadH = parseFloat($('#download').height());\n    mine.on(\"click\",function(){\n         //埋点\n        \n        ga('send', 'event', 'login/sign', 'home_me_click');\n    })\n    login.on(\"click\",function(){\n         //埋点\n       \n        ga('send', 'event', 'login/sign', 'home_login_click');\n    })\n    if (params[\"type\"] == \"callapp\") {\n        appCall.callApp({\n            url: \"/main/mainOpen?tab=MALL\",\n        });\n    }\n    Vue.component(\"listmore\", {\n        props: {\n            items: {\n                type: Array,\n                default: function() {\n                    return []\n                }\n            }\n        },\n        template: \"#prolist_tpl\"\n    });\n    let pageNum = 2;\n    new Vue({\n        el: \"body\",\n        data: {\n            moreData: []\n        },\n        init: function() {\n            //推荐gdy\n            new Swiper('.hot', {\n                pagination: '.pagination',\n                paginationClickable: true,\n                slidesPerView: 'auto'\n            })\n\n            //banner gdy\n            if ($('#swiper-banner').children('.carousel-it').length > 1) {\n                new Swiper('.carousel', {\n                    loop: true,\n                    // 如果需要分页器\n                    lazyLoading: true, //解决轮播到最后再划显示默认图\n                    pagination: '.swiper-pagination'\n\n                })\n            }\n            if($('body').scrollTop()>(downLoadH+navH-10)){\n                headerCate.show();\n            }else{\n                headerCate.hide();\n            }\n            BP.init({\n                dom:\"#goodsList\",\n                pdPos:\"0\",\n                pType:\"0\"\n            });//商品list曝光\n            let self = this;\n            if ($('#goodsList').children('li').length > 0) {\n                $(\"#goodsList\").dropload({\n                    scrollArea: window,\n                    domDown: {\n                        domClass: 'dropload-down',\n                        domRefresh: '<div class=\"dropload-refresh\"><img src=\"' + wapcsspath + '/images/common/loading.png\" alt=\"\"/></div>',\n                        domUpdate: '<div class=\"dropload-update\"><img src=\"' + wapcsspath + '/images/common/loading.png\" alt=\"\"/></div>',\n                        domLoad: '<div class=\"dropload-load\"><img src=\"' + wapcsspath + '/images/common/loading.gif\" alt=\"\"/></div>'\n                    },\n                    loadDownFn: function(me) {\n                        Ajax.query({\n                            url: \"/api/ext/recommendation/items?pageType=AaP0001&pageModule=AaP0001M0003&pageNum=\" + (pageNum++) + \"&pageSize=10\",\n                            success: function(data) {\n                                setTimeout(function() {\n                                    me.resetload();\n                                }, 300);\n                                if (data.code === 200) {\n                                    if (!data.data.items.length) {\n                                        UI.alertSecond(\"Data is loaded\");\n                                        return;\n                                    }\n                                    self.moreData = self.moreData.concat(data.data.items);\n                                    laz.lazyload();\n                                } else {\n                                    UI.alertSecond(data.message);\n                                }\n                            }\n                        });\n                    }\n                });\n            }\n        },\n        methods: {\n            click_show_slayer: function() {\n                searchLayer.layer_show();\n            },\n            click_close_down: function() {\n                $('#download').hide();\n            },\n            click_down: function(e) {\n                var target = e.target || e.srcElement,\n                    $target = $(target);\n                if ($target.hasClass(\"download-btn\")) {\n                    $('#download').hide();\n                    return;\n                }\n                dlApp.dl();\n            }\n        }\n    });\n    $(window).on('scroll',function(){\n        let scTop = $('body').scrollTop();\n            downLoadH = parseFloat($('#download').height());\n        if(scTop>(downLoadH+navH-10)){\n            headerCate.show();\n        }else{\n            headerCate.hide();\n        }\n    })\n});\n"]}