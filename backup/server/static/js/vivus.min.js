/**
 * vivus - JavaScript library to make drawing animation on SVG
 * @version v0.4.0
 * @link https://github.com/maxwellito/vivus
 * @license MIT
 */
"use strict";!function(t,e){function r(r){if("undefined"==typeof r)throw new Error('Pathformer [constructor]: "element" parameter is required');if(r.constructor===String&&(r=e.getElementById(r),!r))throw new Error('Pathformer [constructor]: "element" parameter is not related to an existing ID');if(!(r.constructor instanceof t.SVGElement||/^svg$/i.test(r.nodeName)))throw new Error('Pathformer [constructor]: "element" parameter must be a string or a SVGelement');this.el=r,this.scan(r)}function i(t,e){this.isReady=!1,this.setElement(t,e),this.setOptions(e),this.isReady&&this.init()}r.prototype.TYPES=["line","ellipse","circle","polygon","polyline","rect"],r.prototype.ATTR_WATCH=["cx","cy","points","r","rx","ry","x","x1","x2","y","y1","y2"],r.prototype.scan=function(t){for(var e,r,i,n,a=t.querySelectorAll(this.TYPES.join(",")),s=0;s<a.length;s++)r=a[s],e=this[r.tagName.toLowerCase()+"ToPath"],i=e(this.parseAttr(r.attributes)),n=this.pathMaker(r,i),r.parentNode.replaceChild(n,r)},r.prototype.lineToPath=function(t){var e={},r=t.x1||0,i=t.y1||0,n=t.x2||0,a=t.y2||0;return e.d="M"+r+","+i+"L"+n+","+a,e},r.prototype.rectToPath=function(t){var e={},r=parseFloat(t.x)||0,i=parseFloat(t.y)||0,n=parseFloat(t.width)||0,a=parseFloat(t.height)||0;return e.d="M"+r+" "+i+" ",e.d+="L"+(r+n)+" "+i+" ",e.d+="L"+(r+n)+" "+(i+a)+" ",e.d+="L"+r+" "+(i+a)+" Z",e},r.prototype.polylineToPath=function(t){var e,r,i={},n=t.points.trim().split(" ");if(t.points.indexOf(",")===-1){var a=[];for(e=0;e<n.length;e+=2)a.push(n[e]+","+n[e+1]);n=a}for(r="M"+n[0],e=1;e<n.length;e++)n[e].indexOf(",")!==-1&&(r+="L"+n[e]);return i.d=r,i},r.prototype.polygonToPath=function(t){var e=r.prototype.polylineToPath(t);return e.d+="Z",e},r.prototype.ellipseToPath=function(t){var e={},r=parseFloat(t.rx)||0,i=parseFloat(t.ry)||0,n=parseFloat(t.cx)||0,a=parseFloat(t.cy)||0,s=n-r,o=a,h=parseFloat(n)+parseFloat(r),l=a;return e.d="M"+s+","+o+"A"+r+","+i+" 0,1,1 "+h+","+l+"A"+r+","+i+" 0,1,1 "+s+","+l,e},r.prototype.circleToPath=function(t){var e={},r=parseFloat(t.r)||0,i=parseFloat(t.cx)||0,n=parseFloat(t.cy)||0,a=i-r,s=n,o=parseFloat(i)+parseFloat(r),h=n;return e.d="M"+a+","+s+"A"+r+","+r+" 0,1,1 "+o+","+h+"A"+r+","+r+" 0,1,1 "+a+","+h,e},r.prototype.pathMaker=function(t,r){var i,n,a=e.createElementNS("http://www.w3.org/2000/svg","path");for(i=0;i<t.attributes.length;i++)n=t.attributes[i],this.ATTR_WATCH.indexOf(n.name)===-1&&a.setAttribute(n.name,n.value);for(i in r)a.setAttribute(i,r[i]);return a},r.prototype.parseAttr=function(t){for(var e,r={},i=0;i<t.length;i++){if(e=t[i],this.ATTR_WATCH.indexOf(e.name)!==-1&&e.value.indexOf("%")!==-1)throw new Error("Pathformer [parseAttr]: a SVG shape got values in percentage. This cannot be transformed into 'path' tags. Please use 'viewBox'.");r[e.name]=e.value}return r};var n,a,s;i.LINEAR=function(t){return t},i.EASE=function(t){return-Math.cos(t*Math.PI)/2+.5},i.EASE_OUT=function(t){return 1-Math.pow(1-t,3)},i.EASE_IN=function(t){return Math.pow(t,3)},i.EASE_OUT_BOUNCE=function(t){var e=-Math.cos(t*(.5*Math.PI))+1,r=Math.pow(e,1.5),i=Math.pow(1-t,2),n=-Math.abs(Math.cos(r*(2.5*Math.PI)))+1;return 1-i+n*i},i.prototype.setElement=function(r,i){if("undefined"==typeof r)throw new Error('Vivus [constructor]: "element" parameter is required');if(r.constructor===String&&(r=e.getElementById(r),!r))throw new Error('Vivus [constructor]: "element" parameter is not related to an existing ID');if(this.parentEl=r,i&&i.file){var n=e.createElement("object");n.setAttribute("type","image/svg+xml"),n.setAttribute("data",i.file),n.setAttribute("built-by-vivus","true"),r.appendChild(n),r=n}switch(r.constructor){case t.SVGSVGElement:case t.SVGElement:this.el=r,this.isReady=!0;break;case t.HTMLObjectElement:var a,s;s=this,a=function(t){if(!s.isReady){if(s.el=r.contentDocument&&r.contentDocument.querySelector("svg"),!s.el&&t)throw new Error("Vivus [constructor]: object loaded does not contain any SVG");return s.el?(r.getAttribute("built-by-vivus")&&(s.parentEl.insertBefore(s.el,r),s.parentEl.removeChild(r),s.el.setAttribute("width","100%"),s.el.setAttribute("height","100%")),s.isReady=!0,s.init(),!0):void 0}},a()||r.addEventListener("load",a);break;default:throw new Error('Vivus [constructor]: "element" parameter is not valid (or miss the "file" attribute)')}},i.prototype.setOptions=function(e){var r=["delayed","sync","async","nsync","oneByOne","scenario","scenario-sync"],n=["inViewport","manual","autostart"];if(void 0!==e&&e.constructor!==Object)throw new Error('Vivus [constructor]: "options" parameter must be an object');if(e=e||{},e.type&&r.indexOf(e.type)===-1)throw new Error("Vivus [constructor]: "+e.type+" is not an existing animation `type`");if(this.type=e.type||r[0],e.start&&n.indexOf(e.start)===-1)throw new Error("Vivus [constructor]: "+e.start+" is not an existing `start` option");if(this.start=e.start||n[0],this.isIE=t.navigator.userAgent.indexOf("MSIE")!==-1||t.navigator.userAgent.indexOf("Trident/")!==-1||t.navigator.userAgent.indexOf("Edge/")!==-1,this.duration=s(e.duration,120),this.delay=s(e.delay,null),this.dashGap=s(e.dashGap,1),this.forceRender=e.hasOwnProperty("forceRender")?!!e.forceRender:this.isIE,this.reverseStack=!!e.reverseStack,this.selfDestroy=!!e.selfDestroy,this.onReady=e.onReady,this.onStart=e.onStart,this.onUpdate=e.onUpdate,this.onComplete=e.onComplete,this.map=[],this.frameLength=this.currentFrame=this.delayUnit=this.speed=this.handle=null,this.ignoreInvisible=!!e.hasOwnProperty("ignoreInvisible")&&!!e.ignoreInvisible,this.animTimingFunction=e.animTimingFunction||i.LINEAR,this.pathTimingFunction=e.pathTimingFunction||i.LINEAR,this.delay>=this.duration)throw new Error("Vivus [constructor]: delay must be shorter than duration")},i.prototype.mapping=function(){var e,r,i,n,a,o,h,l;for(l=o=h=0,r=this.el.querySelectorAll("path"),e=0;e<r.length;e++)i=r[e],this.isInvisible(i)||(a={id:i.id,el:i,length:Math.ceil(i.getTotalLength())},isNaN(a.length)?t.console&&console.warn&&console.warn("Vivus [mapping]: cannot retrieve a path element length",i):(this.map.push(a),i.style.strokeDasharray=a.length+" "+(a.length+2*this.dashGap),i.style.strokeDashoffset=a.length+this.dashGap,a.length+=this.dashGap,o+=a.length,this.renderPath(e)));for(o=0===o?1:o,this.delay=null===this.delay?this.duration/3:this.delay,this.delayUnit=this.delay/(r.length>1?r.length-1:1),this.reverseStack&&this.map.reverse(),e=0;e<this.map.length;e++){switch(a=this.map[e],this.type){case"delayed":a.startAt=this.delayUnit*e,a.duration=this.duration-this.delay;break;case"oneByOne":a.startAt=h/o*this.duration,a.duration=a.length/o*this.duration;break;case"sync":case"async":case"nsync":a.startAt=0,a.duration=this.duration;break;case"scenario-sync":i=a.el,n=this.parseAttr(i),a.startAt=l+(s(n["data-delay"],this.delayUnit)||0),a.duration=s(n["data-duration"],a.length/o*this.duration),l=void 0!==n["data-async"]?a.startAt:a.startAt+a.duration,this.frameLength=Math.max(this.frameLength,a.startAt+a.duration);break;case"scenario":i=a.el,n=this.parseAttr(i),a.startAt=s(n["data-start"],this.delayUnit)||0,a.duration=s(n["data-duration"],this.duration),this.frameLength=Math.max(this.frameLength,a.startAt+a.duration)}h+=a.length,this.frameLength=this.frameLength||this.duration}},i.prototype.drawer=function(){var t=this,e=0,r=1,i=+new Date;if(this.timeLast>0&&(e=i-this.timeLast,r=e/(1e3/60)),this.timeLast=i,this.currentFrame+=this.speed*r,this.currentFrame<=0)this.stop(),this.reset();else{if(!(this.currentFrame>=this.frameLength))return this.trace(),void(this.handle=n(function(){t.drawer()}));this.stop(),this.currentFrame=this.frameLength,this.trace(),this.selfDestroy&&this.destroy()}this.onComplete&&this.onComplete(this),this.instanceCallback&&(this.instanceCallback(this),this.instanceCallback=null)},i.prototype.trace=function(){var t,e,r,i;for(i=this.animTimingFunction(this.currentFrame/this.frameLength)*this.frameLength,t=0;t<this.map.length;t++)r=this.map[t],e=(i-r.startAt)/r.duration,e=this.pathTimingFunction(Math.max(0,Math.min(1,e))),this.progress=e,r.progress!==e&&(!this.targetPaths.length||this.targetPaths.length&&this.targetPaths.indexOf(r.id)>=0)&&(r.progress=e,r.el.style.strokeDashoffset=Math.floor(r.length*(1-e)),this.renderPath(t));this.onUpdate&&this.onUpdate(this)},i.prototype.renderPath=function(t){if(this.forceRender&&this.map&&this.map[t]){var e=this.map[t],r=e.el.cloneNode(!0);e.el.parentNode.replaceChild(r,e.el),e.el=r}},i.prototype.init=function(){this.frameLength=0,this.currentFrame=0,this.timeLast=0,this.progress=0,this.map=[],this.targetPaths=[],new r(this.el),this.mapping(),this.onReady&&this.onReady(this),this.starter(),this.onStart&&this.onStart(this)},i.prototype.starter=function(){switch(this.start){case"manual":return;case"autostart":this.play();break;case"inViewport":var e=this,r=function(){e.isInViewport(e.parentEl,1)&&(e.play(),t.removeEventListener("scroll",r))};t.addEventListener("scroll",r),r()}},i.prototype.getStatus=function(){return 0===this.currentFrame?"start":this.currentFrame===this.frameLength?"end":"progress"},i.prototype.reset=function(){return this.setFrameProgress(0)},i.prototype.finish=function(){return this.setFrameProgress(1)},i.prototype.setFrameProgress=function(t,e){return this.timeLast=0,this.targetPaths=e&&e.paths||[],t=Math.min(1,Math.max(0,t)),this.currentFrame=Math.round(this.frameLength*t),this.progress=t,this.trace(),this.targetPaths=[],this},i.prototype.play=function(t,e,r){if(this.instanceCallback=null,t&&"function"==typeof t)this.instanceCallback=t,t=null;else if(t&&"object"==typeof t)r=t,t=null;else if(t&&"number"!=typeof t)throw new Error("Vivus [play]: invalid speed");return e&&"function"==typeof e&&!this.instanceCallback?this.instanceCallback=e:e&&"object"==typeof e&&(r=e),r=r||{},this.targetPaths=r&&r.paths||[],this.timeLast=0,this.speed=t||1,this.handle||this.drawer(),this},i.prototype.stop=function(){return this.timeLast=0,this.handle&&(a(this.handle),this.handle=null),this},i.prototype.destroy=function(){this.stop();var t,e;for(t=0;t<this.map.length;t++)e=this.map[t],e.el.style.strokeDashoffset=null,e.el.style.strokeDasharray=null,this.renderPath(t)},i.prototype.isInvisible=function(t){var e,r=t.getAttribute("data-ignore");return null!==r?"false"!==r:!!this.ignoreInvisible&&(e=t.getBoundingClientRect(),!e.width&&!e.height)},i.prototype.parseAttr=function(t){var e,r={};if(t&&t.attributes)for(var i=0;i<t.attributes.length;i++)e=t.attributes[i],r[e.name]=e.value;return r},i.prototype.isInViewport=function(t,e){var r=this.scrollY(),i=r+this.getViewportH(),n=t.getBoundingClientRect(),a=n.height,s=r+n.top,o=s+a;return e=e||0,s+a*e<=i&&o>=r},i.prototype.docElem=t.document.documentElement,i.prototype.getViewportH=function(){var e=this.docElem.clientHeight,r=t.innerHeight;return e<r?r:e},i.prototype.scrollY=function(){return t.pageYOffset||this.docElem.scrollTop},n=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){return t.setTimeout(e,1e3/60)}}(),a=function(){return t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.mozCancelAnimationFrame||t.oCancelAnimationFrame||t.msCancelAnimationFrame||function(e){return t.clearTimeout(e)}}(),s=function(t,e){var r=parseInt(t,10);return r>=0?r:e},"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof exports?module.exports=i:t.Vivus=i}(window,document);