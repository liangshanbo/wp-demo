!function(t){function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var e={};n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=3)}({3:function(t,n,e){"use strict";function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var o,a=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}();void 0!==(o=function(t,n,o){e(!function(){var t=new Error('Cannot find module "$"');throw t.code="MODULE_NOT_FOUND",t}()),e(!function(){var t=new Error('Cannot find module "lib/zeptojs/fx"');throw t.code="MODULE_NOT_FOUND",t}());var s=e(!function(){var t=new Error('Cannot find module "utils/async/ajax"');throw t.code="MODULE_NOT_FOUND",t}()),u=e(!function(){var t=new Error('Cannot find module "mods/swiper"');throw t.code="MODULE_NOT_FOUND",t}()),r=e(!function(){var t=new Error('Cannot find module "mods/check/mobile"');throw t.code="MODULE_NOT_FOUND",t}()),c=e(!function(){var t=new Error('Cannot find module "mods/storage/storage"');throw t.code="MODULE_NOT_FOUND",t}()),l={WIN:[[1,0,1],[0,0,1],[0,1,1],[0,1,0],[1,0,0]],LOSE:[[0,0,0],[1,1,1],[1,1,0]]},d=$("#main .head .price"),_=function(){function t(){i(this,t),this.playing=!1,this.isToggleing=!1,this.u=160,this.total_bonus_amount=0,this.data={bFirstRule:!0,bFirstReward:!0,num:1,result:{}},this._init(),this.bindEvent()}return a(t,[{key:"bindEvent",value:function(){var t=this;$(".go").on("click",function(){t.playing||(t.playing=!0,t.get_login(function(){t._ajax_playing()},function(){t._go_btn_reset(),t.login(function(){})}))}),$(".sign").on("click",function(){$(this).hasClass("disable")||t._sign()}),$(".btn").on("touchstart touchend",function(t){var n=this,e=$(this);e.hasClass("go")?"touchstart"!=t.type||n.playing||e.addClass("active"):e.toggleClass("active")}),$(".btns li").on("click",function(){var n=$(this).attr("type");if("share"==n)return void t.get_login(function(){t.share()},function(){t.login(function(){t.share()})});t._popup(n)}),$(".price").on("click",function(){t.get_login(function(){t._popup("reward")},function(){t.login()})});var n=$("#popup");n.find(".close").on("click",function(){n.hide()}),n.find(".share img").on("click",function(){t.share()})}},{key:"_init",value:function(){var t=this;this.get_login(function(n){t._get_bonus()},function(){}),setTimeout(function(){t._pricebeat()},1e3);var n=t._get_time();c.getItem("slot_"+n)&&t._set_sign_dis()}},{key:"_go_btn_reset",value:function(){this.playing=!1,$(".go").removeClass("active")}},{key:"_pricebeat",value:function(){var t=this;d.toggleClass("active"),setTimeout(function(){t._pricebeat()},1e3)}},{key:"_sign",value:function(){var t=this;this.get_login(function(n){s.post({url:"/api/activity/signing",success:function(n){var e=t._get_time();c.setItem("slot_"+e,1),t._set_sign_dis(),200==n.code?(t.toast("sign success"),t._get_task_data(),t._set_bonus_num(5,!0)):t.toast(n.message)}})},function(){t.login()})}},{key:"_set_sign_dis",value:function(){$("#main .foot .sign").addClass("disable")}},{key:"_get_bonus",value:function(){var t=this;t._get_task_data(),s.query({url:"/api/activity/slots/bonuses",data:{pageNum:1,pageSize:6},success:function(n){if(200==n.code){var e=n.data.totalAmount.amount;t._set_bonus_amount(e),t._set_reward(n.data.bonuses,n.data.totalAmount.symbol)}}})}},{key:"_get_task_data",value:function(){var t=this;s.query({url:"/api/activity/slots/asset",success:function(n){200==n.code?(t._set_bonus_num(n.data.countBalance),t._set_task(n.data)):t.toast(n.message)}})}},{key:"_set_reward",value:function(t,n){var e=$("#popup .reward"),i=e.find("ul"),o="",a=this,s="";n&&e.find(".title span.symbol").html(n),i.find("li").length>0&&(s=i.find("li").eq(0).attr("style"));for(var u=0,r=t.length;u<r;u++){var c=t[u];o+="<li class='swiper-slide' style='"+s+"'>",o+=a._get_time(c.bonusTime)+" get "+c.amount.amount/100+" â‚¹",o+="</li>"}i.append(o)}},{key:"_get_time",value:function(t){var n=t?new Date(t):new Date,e=n.getFullYear(),i=n.getMonth()+1,o=n.getDate();if(i=i>9?i:"0"+i,o=o>9?o:"0"+o,t){var a=n.getHours(),s=n.getMinutes();return a=a>9?a:"0"+a,s=s>9?s:"0"+s,e+" "+i+"."+o+" "+a+":"+s}return e+"_"+i+"_"+o}},{key:"_set_task",value:function(t){var n=$("#popup .task");for(var e in t)"COMPLETED"===t[e]&&n.find("li."+e).addClass("active")}},{key:"_set_bonus_amount",value:function(t){if(!(t<=0)){t/=100,this.total_bonus_amount+=t,t=this.total_bonus_amount,$("#popup .reward .amount").html(t),t=(t+"").split("");for(var n=$(".head .price dd"),e=t.length,i=n.length,o=t.length;o>0;o--)n.eq(i-1-e+o).html(t[o-1])}}},{key:"_set_bonus_num",value:function(t,n){var e=$(".ctls .nums");n&&(t+=parseInt(e.html())),e.html(t)}},{key:"_ajax_playing",value:function(){var t=this;s.post({url:"/api/activity/slots/gamePlaying",success:function(n){if(200!=n.code)return t.toast("Your chance is 0, you can get through the task to get more chance to win!"),void t._go_btn_reset();t.data.result=n,$(".content li").css("backgroundPositionY",0),t.data.num=1,t._go()},error:function(){t._go_btn_reset(),t.data.result={}}})}},{key:"_go",value:function(){var t=this,n=$(".content li"),e=t.data.num++,i=t.data.result,o=i.data.bonusStatus,a=[];if("WIN"==o)a=l.WIN[i.data.bonusLevel-1];else{var s=Math.floor(3*Math.random());a=l.LOSE[s]}n.each(function(s){!function(s){n.eq(s).animate({backgroundPositionY:-100*(10*e+a[s])+"%"},{duration:3e3+3e3*s,easing:"easeInOutCirc",complete:function(){if(2==s){if("WIN"===o){var n=$("#popup"),e=i.data,a=e.bonusAmount.amount,u={};n.find(".win").find(".bonus").html(a/100),t._popup("win",!0),t._set_bonus_amount(a),u.bonusTime=(new Date).valueOf(),u.amount=e.bonusAmount,t._set_reward([u])}t._set_bonus_num(i.data.countBalance),t._go_btn_reset()}}})}(s)})}},{key:"_popup",value:function(t,n){var e=$("#popup"),i=this;if("win"==t)e.find(".win").show().siblings().hide();else if(e.find("."+t).length){switch(e.find(".box_head").show(),e.find(".box_deco").show(),e.find(".box .close").show(),t){case"rules":e.find(".box_deco").hide(),e.find(".box_head").hide(),i.data.bFirstRule&&(i.data.bFirstRule=!1,setTimeout(function(){new u(".rules .swiper-container",{pagination:".swiper-pagination"})},0));break;case"download":e.find(".box_deco").hide(),e.find(".box_head").hide(),r.isIOS?e.find(".android").hide():e.find(".ios").hide(),e.find(".box .close").hide();break;case"reward":i.data.bFirstReward&&e.find(".reward li").length>1&&(i.data.bFirstReward=!1,setTimeout(function(){new u(".reward .swiper-container",{slidesPerView:1,direction:"vertical"})},0))}e.find(".box").show().siblings().hide(),e.find(".box_head>."+t).show().siblings().hide(),e.find(".box_content>."+t).show().siblings().hide()}e.show(),n&&setTimeout(function(){e.hide()},3e3)}}]),t}();o.exports=_}.call(n,e,n,t))&&(t.exports=o)}});
//# sourceMappingURL=slotmachine.js.map