!function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=3)}({3:function(t,e,n){"use strict";var r;void 0!==(r=function(t,e,r){var a=n(!function(){var t=new Error('Cannot find module "$"');throw t.code="MODULE_NOT_FOUND",t}()),o=n(!function(){var t=new Error('Cannot find module "vue"');throw t.code="MODULE_NOT_FOUND",t}()),c=n(!function(){var t=new Error('Cannot find module "UI/dialog/alert"');throw t.code="MODULE_NOT_FOUND",t}()),i=n(!function(){var t=new Error('Cannot find module "utils/async/ajax.js"');throw t.code="MODULE_NOT_FOUND",t}()),u=n(!function(){var t=new Error('Cannot find module "mods/storage/storage"');throw t.code="MODULE_NOT_FOUND",t}()),d=n(!function(){var t=new Error('Cannot find module "conf/account/_common.js"');throw t.code="MODULE_NOT_FOUND",t}());a(function(){function t(){var t=document.createElement("script");t.async="async",t.src="https://cdn.jsdelivr.net/clipboard.js/1.6.1/clipboard.min.js",document.getElementsByTagName("head")[0].appendChild(t),t.onload=function(){var t=document.querySelectorAll(".copy-btn"),e=new Clipboard(t);e.on("success",function(t){c.alertSecond("Copied"),t.clearSelection()}),e.on("error",function(t){c.alertSecond("Auto-copy failed. Please copy manually.")})}}var e={commonMod:d,bindCopyEvents:t,renderCompleted:!1,cardListRes:{data:{totalExchange:{amount:0},myGiftCards:[]}},showHelpLayer:!1,targetCardId:"",targetUseStatus:null},n=new o({el:"body",data:function(){return e},computed:{sortedListData:function(){var t=function(t){return function(e,n){return-(e[t].valueOf()-n[t].valueOf())}},e=this.cardListRes.data.myGiftCards.filter(function(t){return"UNBIND"!==t.exchangeStatus&&"NO_USERED"!==t.useStatus}),n=e.filter(function(t){return"UNUSED"===t.useStatus&&"ALREADY_EXCHANGE"===t.exchangeStatus}),r=e.filter(function(t){return"ALREADY_BIND"===t.exchangeStatus}),a=e.filter(function(t){return"USED"===t.useStatus}),o=n.sort(t("exchangeDate")),c=r.sort(t("distributeDate")),i=a.sort(t("exchangeDate"));return o.concat(c).concat(i)}},methods:{fetchGiftCardsData:function(){i.query({url:"/api/trade/myGiftCards",data:{pageNum:0,pageSize:0},success:function(t){200===t.code&&(n.cardListRes=t,n.$nextTick(function(){n.checkIfShouldShowTutorial(),n.bindCopyEvents()})),n.renderCompleted=!0,""!==n.targetCardId&&d.scrollIntoTargetSelector("[data-is-scroll-target]")},error:function(){n.renderCompleted=!0}})},attachLongPressEvt:function(t){var e=void 0,r=void 0,o=void 0,c=void 0,i=a("body");i.on("touchstart",".cards-li",function(t){o=t.targetTouches[0].clientX,c=t.targetTouches[0].clientY,e=(new Date).valueOf();var r=a(t.target);n.targetCardId=r.data("card-id")||"",n.targetUseStatus="USED"===r.data("use-status")?"UNUSED":"USED"}).on("touchend",".cards-li",function(u){if(a(u.target).data("card-id")===n.targetCardId)t();else{r=(new Date).valueOf();var d=Math.abs(u.changedTouches[0].clientY-c)<10&&Math.abs(u.changedTouches[0].clientX-o)<10,s=r-e>200;d&&s?a(this).children(".mark-wrap").show():i.find(".mark-wrap").hide()}})},sendSwitchUseStatusReq:function(){i.put({url:"/api/trade/myGiftCard",data:{cardId:n.targetCardId.toString(),useStatus:n.targetUseStatus},success:function(t){200===t.code?n.fetchGiftCardsData():c.alertSecond("Change use status failed")},error:function(){}})},checkIfShouldShowTutorial:function(){null===u.getItem("hadSeenTutorial")&&a("body").find(".cards-li").not(".disabled").length>0&&(document.body.scrollTop=0,d.showTutorial(".cards-li","Long press to mark the usage of Gift Card.",function(){u.setItem("hadSeenTutorial",!0)}))}},init:function(){d.setFilters()},created:function(){this.fetchGiftCardsData()},ready:function(){this.attachLongPressEvt(this.sendSwitchUseStatusReq)}})})}.call(e,n,e,t))&&(t.exports=r)}});
//# sourceMappingURL=giftcard.js.map